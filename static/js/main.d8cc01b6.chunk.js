(this["webpackJsonpmouse-events-demo"]=this["webpackJsonpmouse-events-demo"]||[]).push([[0],{21:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(i(29));function o(e,t){for(var i=void 0,n=void 0,a=0;a<e.length;a++){var o=e[a],d=t(o);if(void 0!==d){if(d<=0)return{idx:a,item:o};(void 0===n||d<n)&&(i={idx:a,item:o},n=d)}}return i}function d(e,t,i){return e<t?t-e:e>i?e-i:0}function r(e){return e.getYForLine(((e.options.num_lines||5)-1)/2)}function c(e,t){var i=e.x,n=e.y,a=t.x,o=t.y,r=t.w,c=t.h,s=d(i,a,a+r),v=d(n,o,o+c);return Math.sqrt(Math.pow(s,2)+Math.pow(v,2))}function s(e){for(var t=e.getActualResolution(),i=new a.default.Flow.Fraction(0,1),n=[],o=0,d=e.getTickables();o<d.length;o++){var r=d[o];n.push({tickable:r,beat:i});var c=r.getTicks().clone().divide(t,1);i=i.clone().add(c.numerator,c.denominator).simplify()}return n}function v(e,t){var i=e.map((function(e){return function(e,t){for(var i=void 0,n=void 0,a=0,o=s(e);a<o.length;a++){var d=o[a],r=d.tickable.getBoundingBox();if(r){var c=r.getX(),v=r.getW();if(c>t){n=d;break}if(i=d,c+v>t)break}}return[i,n].filter((function(e){return void 0!==e}))}(e,t.x)})),n=i.reduce((function(e,i){var n;return!i||i.length<1?e:null===(n=o([e,i[0]].filter((function(e){return void 0!==e})),(function(e){return c(t,e.tickable.getBoundingBox())})))||void 0===n?void 0:n.item}),void 0);return{closestTickable:i.flatMap((function(e){return e})).reduce((function(e,i){var n;return null===(n=o([e,i].filter((function(e){return void 0!==e})),(function(e){return c(t,e.tickable.getBoundingBox())})))||void 0===n?void 0:n.item}),void 0),closestTickableBefore:n}}function l(e){if(!e)return 0;switch(e.toLocaleLowerCase()){case"bb":return-2;case"b":return-1;case"#":return 1;case"##":return 2;case"n":default:return 0}}function u(){for(var e={},t=0,i=Object.entries(a.default.Flow.keyProperties.note_values);t<i.length;t++){var n=i[t],o=n[0],d=n[1],r=d.index,c=d.int_val,s=d.accidental,v=d.rest,u=d.code;if(!v&&!u){var f=e[r];f||(f={noteLetter:o[0]},e[r]=f);var b=l(s),g=o[0];f[b]={semitoneVal:c,noteName:{accidental:s||"n",noteLetter:g},noteLetterIdx:r}}}return e}function f(e){var t=e.trim();if(t&&t.length){var i=t[0].toUpperCase();switch(i){case"A":case"B":case"C":case"D":case"E":case"F":case"G":break;default:return}var n=void 0,a=t.substring(1);if(a.length>0)switch(n=a){case"##":case"#":case"b":case"bb":case"n":break;default:return}return{accidental:n,noteLetter:i}}}function b(e){return e.noteLetter+(e.accidental||"")}t.getNoteMap=u,t.NOTE_MAPPING=u();function g(e){var i=f(e.keySpec);return i?t.KEY_SIGNATURE_MAP[b(i)]:void 0}function h(e,t){var i=e.clone().subtract(t).numerator;return Math.min(1,Math.max(-1,i))}function m(e,t){var i={};return e.flatMap((function(e){return s(e)})).flatMap((function(e){var t=e.tickable,i=e.beat;if(t.getCategory()===a.default.Flow.StaveNote.CATEGORY){var n=t,o={};if(n.modifiers)for(var d=0,r=n.modifiers;d<r.length;d++){var c=r[d];c.getCategory()===a.default.Flow.Accidental.CATEGORY&&(o[c.index]=c.type)}return t.getKeys().map((function(e,t){return{key:e,beat:i,accidental:o[t]}}))}return[]})).map((function(e){var t=e.key,i=e.beat,n=e.accidental,a=function(e){var t=e.split("/");if(2===t.length){var i=f(t[0]),n=parseInt(t[1],10);return i&&n&&!isNaN(n)?{note:i,octave:n}:void 0}}(t);return n&&(null===a||void 0===a?void 0:a.note)&&!a.note.accidental&&(a.note.accidental=n),{note:a,beat:i}})).filter((function(e){var i=e.note,n=e.beat;return i&&i.note.accidental&&h(n,t)<=0})).sort((function(e,t){return h(e.beat,t.beat)})).forEach((function(e){var t=e.note;t&&t.note.accidental&&(i[t.note.noteLetter+t.octave]=t.note.accidental)})),i}t.KEY_SIGNATURE_MAP=function(e){for(var t={},i=0,n=Object.entries(e);i<n.length;i++){var a=n[i],o=a[0],d=a[1],r=f(o);if(r){for(var c={},s=0,v=d;s<v.length;s++){var l=f(v[s]);l&&l.accidental&&(c[null===l||void 0===l?void 0:l.noteLetter]=l.accidental)}t[b(r)]=c}}return t}({C:[],G:["F#"],D:["F#","C#"],A:["F#","C#","G#"],E:["F#","C#","G#","D#"],B:["F#","C#","G#","D#","A#"],"F#":["F#","C#","G#","D#","A#","E#"],"C#":["F#","C#","G#","D#","A#","E#","B#"],F:["Bb"],Bb:["Bb","Eb"],Eb:["Bb","Eb","Ab"],Ab:["Bb","Eb","Ab","Db"],Db:["Bb","Eb","Ab","Db","Gb"],Gb:["Bb","Eb","Ab","Db","Gb","Cb"],Cb:["Bb","Eb","Ab","Db","Gb","Cb","Fb"]}),t.getScoreMouseEvent=function(e,i,n,d){var s,u,f,b;void 0===n&&(n=t.NOTE_MAPPING),void 0===d&&(d=!0);var h=function(e,t){return o(e,(function(e){var i,n,a,o=null===(i=null===e||void 0===e?void 0:e.options)||void 0===i?void 0:i.x,d=null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.y,r=null===(a=null===e||void 0===e?void 0:e.options)||void 0===a?void 0:a.width,s=void 0!==d&&(null===e||void 0===e?void 0:e.lastY)&&e.lastY-d>0?e.lastY-d:void 0;return void 0!==o&&void 0!==d&&void 0!==r&&void 0!==s?c(t,{x:o,y:d,w:r,h:s}):void 0}))}(e,i),p=void 0,C=void 0,S=void 0,y=void 0,B=void 0,x=void 0,G=void 0,E=void 0,w=void 0;if(h){p=h.item,C=h.idx;var A=o(p.parts.map((function(e){return e.stave})),(function(e){return Math.abs(i.y-r(e))}));if(y=(s=A||{item:void 0,idx:void 0}).item,S=s.idx,y&&void 0!==S)if(G=function(e,t){var i=r(e),n=e.options.spacing_between_lines_px||0;return Math.round((i-t.y)/(n/2))}(y,i),(null===(b=null===(f=p)||void 0===f?void 0:f.parts)||void 0===b?void 0:b.length)>S)if(B=(u=v(p.parts[S].voices,i)).closestTickable,x=u.closestTickableBefore,n&&x&&void 0!==G){var R=x.tickable;w=d?function(e,t,i,n){var o,d,r=void 0,c=void 0;if(e.length>i){for(var s=i;s>=0;s--){var v=e[s].parts;if(v.length>t&&v[t].stave){var l=v[t].stave.getModifiers().find((function(e){return e.getCategory()===a.default.Flow.KeySignature.CATEGORY}));if(l){r=g(l);break}}}var u=null===(d=null===(o=e[i])||void 0===o?void 0:o.parts)||void 0===d?void 0:d.flatMap((function(e){return e.voices}));u&&(c=m(u,n))}return{keySig:r||{},accidentalOverrides:c||{}}}(e,S,C,x.beat):void 0,E=function(e,t,i,n,o){void 0===n&&(n=0);for(var d=i-2*a.default.Flow.clefProperties(t).line_shift-1,r=5-n;d<0;)d+=7,r-=1;for(;d>=7;)d-=7,r+=1;var c=e[d];if(c){var s=c.noteLetter,v=0;if(o){var u=o.accidentalOverrides[s+r];u||(u=o.keySig[s]),u&&(v=l(u))}return{note:c[v],octave:r}}}(n,R.clef,G,R.octave_shift,w)}}return{accidentals:w,measureIdx:C,closestSystemMeasure:p,closestStaveIdx:S,closestStave:y,closestTickable:B,closestTickableBefore:x,centerLineOffset:G,effectivePitch:E,mouseX:i.x,mouseY:i.y}}},28:function(e,t,i){},30:function(e,t,i){"use strict";i.r(t);var n=i(14),a=i.n(n),o=i(22),d=i.n(o),r=i(0),c=i(1),s=i(2),v=i(3),l=i(21),u=i(13),f=i(12),b="eventDemo",g=function(e){Object(s.a)(i,e);var t=Object(v.a)(i);function i(e){var n;return Object(r.a)(this,i),(n=t.call(this,e)).myRef=null,n.systems=[],n.myRef=a.a.createRef(),n}return Object(c.a)(i,[{key:"componentDidMount",value:function(){this.systems=function(e){var t=[];function i(e,t){return e.concat(t)}var n=new u.a.Flow.Registry;u.a.Flow.Registry.enableDefaultRegistry(n);var a=new u.a.Flow.Factory({renderer:{elementId:e,height:800,width:1200}}),o=a.EasyScore({throwOnError:!0}),d=o.voice.bind(o),r=o.notes.bind(o),c=o.beam.bind(o),s=120,v=80;function l(e){var t=a.System({x:s,y:v,width:e,spaceBetweenStaves:10});return s+=e,t}o.set({time:"3/4"});var f=l(220);return f.addStave({voices:[d([r('D5/q[id="m1a"]'),c(r("G4/8, A4, B4, C5",{stem:"up"}))].reduce(i)),d([a.TextDynamics({text:"p",duration:"h",dots:1,line:9})])]}).addClef("treble").addKeySignature("Bb").addTimeSignature("3/4").setTempo({name:"Allegretto",duration:"h",dots:1,bpm:66},-30),f.addStave({voices:[d(r("(G3 B3 D4)/h, A3/q",{clef:"bass"}))]}).addClef("bass").addKeySignature("G").addTimeSignature("3/4"),f.addConnector("brace"),f.addConnector("singleRight"),f.addConnector("singleLeft"),t.push(f),(f=l(150)).addStave({voices:[d(r('D5/q[id="m2a"], G4[id="m2b"], G4[id="m2c"]'))]}),f.addStave({voices:[d(r("B3/h.",{clef:"bass"}))]}),f.addConnector("singleRight"),t.push(f),(f=l(150)).addStave({voices:[d([r('E5/q[id="m3a"]'),c(r("(C#5 Gb5)/8, D5, En5, F5",{stem:"down"}))].reduce(i))]}),f.addStave({voices:[d(r("C4/h.",{clef:"bass"}))]}),f.addConnector("singleRight"),t.push(f),(f=l(150)).addStave({voices:[d(r('G5/q[id="m4a"], G4[id="m4b"], G4[id="m4c"]'))]}),f.addStave({voices:[d(r("B3/h.",{clef:"bass"}))]}),f.addConnector("singleRight"),t.push(f),(f=l(150)).addStave({voices:[d([r('C5/q[id="m5a"]'),c(r("D5/8, C5, B4, A4",{stem:"down"}))].reduce(i))]}),f.addStave({voices:[d(r("A3/h.",{clef:"bass"}))]}),f.addConnector("singleRight"),t.push(f),(f=l(150)).addStave({voices:[d([r("B4/q"),c(r('C5/8, B4, A4, G4[id="m6a"]',{stem:"up"}))].reduce(i))]}),f.addStave({voices:[d(r("G3/h.",{clef:"bass"}))]}),f.addConnector("singleRight"),t.push(f),s=20,v+=230,(f=l(220)).addStave({voices:[d([r('F4/q[id="m7a"]'),c(r('G4/8[id="m7b"], A4, B4, G4',{stem:"up"}))].reduce(i))]}).addClef("treble").addKeySignature("G"),f.addStave({voices:[d(r('D4/q, B3[id="m7c"], G3',{clef:"bass"}))]}).addClef("bass").addKeySignature("G"),f.addConnector("brace"),f.addConnector("singleRight"),f.addConnector("singleLeft"),t.push(f),f=l(180),a.GraceNote({keys:["d/3"],clef:"bass",duration:"8",slash:!0}),f.addStave({voices:[d(r('A4/h.[id="m8c"]'))]}),f.addStave({voices:[o.set({clef:"bass"}).voice([r('D4/q[id="m8a"]'),c(r('D3/8, C4, B3[id="m8b"], A3',{stem:"down"}))].reduce(i))]}),f.addConnector("singleRight"),t.push(f),(f=l(180)).addStave({voices:[o.set({clef:"treble"}).voice([r('D5/q[id="m9a"]'),c(r("G4/8, A4, B4, C5",{stem:"up"}))].reduce(i))]}),f.addStave({voices:[d(r("B3/h, A3/q",{clef:"bass"}))]}),f.addConnector("singleRight"),t.push(f),(f=l(170)).addStave({voices:[d(r('D5/q[id="m10a"], G4[id="m10b"], G4[id="m10c"]'))]}),f.addStave({voices:[d(r('G3/q[id="m10d"], B3, G3',{clef:"bass"}))]}),f.addConnector("singleRight"),t.push(f),(f=l(150)).addStave({voices:[d([r('E5/q[id="m11a"]'),c(r("C5/8, D5, E5, F5",{stem:"down"}))].reduce(i))]}),f.addStave({voices:[d(r("C4/h.",{clef:"bass"}))]}),f.addConnector("singleRight"),t.push(f),(f=l(170)).addStave({voices:[d(r('G5/q[id="m12a"], G4[id="m12b"], G4[id="m12c"]'))]}),f.addStave({voices:[o.set({clef:"bass"}).voice([r('B3/q[id="m12d"]'),c(r('C4/8, B3, A3, G3[id="m12e"]',{stem:"down"}))].reduce(i))]}),f.addConnector("singleRight"),t.push(f),s=20,v+=230,(f=l(220)).addStave({voices:[o.set({clef:"treble"}).voice([r('c5/q[id="m13a"]'),c(r("d5/8, c5, b4, a4",{stem:"down"}))].reduce(i))]}).addClef("treble").addKeySignature("G"),f.addStave({voices:[d(r('a3/h[id="m13b"], f3/q[id="m13c"]',{clef:"bass"}))]}).addClef("bass").addKeySignature("G"),f.addConnector("brace"),f.addConnector("singleRight"),f.addConnector("singleLeft"),t.push(f),(f=l(180)).addStave({voices:[o.set({clef:"treble"}).voice([r("B4/q"),c(r("C5/8, b4, a4, g4",{stem:"up"}))].reduce(i))]}),f.addStave({voices:[d(r('g3/h[id="m14a"], b3/q[id="m14b"]',{clef:"bass"}))]}),f.addConnector("singleRight"),t.push(f),(f=l(180)).addStave({voices:[o.set({clef:"treble"}).voice([r("a4/q"),c(r('b4/8, a4, g4, f4[id="m15a"]',{stem:"up"}))].reduce(i))]}),f.addStave({voices:[d(r('c4/q[id="m15b"], d4, d3',{clef:"bass"}))]}),f.addConnector("singleRight"),t.push(f),(f=l(130)).addStave({voices:[o.set({clef:"treble"}).voice([r('g4/h.[id="m16a"]')].reduce(i))]}).setEndBarType(u.a.Flow.Barline.type.REPEAT_END),f.addStave({voices:[d(r('g3/h[id="m16b"], g2/q',{clef:"bass"}))]}).setEndBarType(u.a.Flow.Barline.type.REPEAT_END),f.addConnector("boldDoubleRight"),t.push(f),(f=l(180)).addStave({voices:[o.set({clef:"treble"}).voice([r('b5/q[id="m17a"]'),c(r("g5/8, a5, b5, g5",{stem:"down"}))].reduce(i)),d([a.TextDynamics({text:"mf",duration:"h",dots:1,line:10})])]}).setBegBarType(u.a.Flow.Barline.type.REPEAT_BEGIN),f.addStave({voices:[d(r("g3/h.",{clef:"bass"}))]}).setBegBarType(u.a.Flow.Barline.type.REPEAT_BEGIN),f.addConnector("boldDoubleLeft"),f.addConnector("singleRight"),t.push(f),(f=l(180)).addStave({voices:[o.set({clef:"treble"}).voice([r('a5/q[id="m18a"]'),c(r('d5/8, e5, f5, d5[id="m18b"]',{stem:"down"}))].reduce(i))]}),f.addStave({voices:[d(r("f3/h.",{clef:"bass"}))]}),f.addConnector("singleRight"),t.push(f),a.draw(),t}(b)}},{key:"onClick",value:function(e,t){var i=this.myRef.current.getBoundingClientRect(),n={x:e.clientX-i.left-30,y:e.clientY-i.top-30},a=Object(l.getScoreMouseEvent)(t,n,Object(l.getNoteMap)(),!0);this.setState({mouseEvent:a}),console.log(a)}},{key:"render",value:function(){var e,t,i=this,n=null===this||void 0===this||null===(e=this.state)||void 0===e?void 0:e.mouseEvent;return Object(f.jsxs)("div",{style:{width:"100vw",height:"100vh",overflow:"auto",margin:0,padding:0},children:[Object(f.jsx)("div",{style:{marginBottom:"300px"},children:Object(f.jsx)("div",{id:b,style:{paddingLeft:"".concat(30,"px"),paddingTop:"".concat(30,"px")},ref:this.myRef,onClick:function(e){return i.onClick(e,i.systems)}})}),n&&Object(f.jsx)("div",{style:{position:"absolute",bottom:"25px",right:"25px",marginLeft:"25px",padding:"0px 5px",backgroundColor:"#fafafa",borderRadius:"8px",border:"1px solid #ddd",boxShadow:"3px 5px 3px #888888"},children:[["Accidentals",JSON.stringify(n.accidentals)],["Centerline Offset",n.centerLineOffset],["Closest Staves Index",n.closestStaveIdx],["Tickable Before Beat",null===(t=n.closestTickableBefore)||void 0===t?void 0:t.beat],["Effective Pitch",JSON.stringify(n.effectivePitch)],["Measure Index",n.measureIdx],["Mouse X",n.mouseX],["Mouse Y",n.mouseY]].map((function(e){var t,i;return Object(f.jsxs)("p",{children:[e[0],": ",null===(i=e[1])||void 0===i?void 0:i.toString()]},null===(t=e[0])||void 0===t?void 0:t.toString())}))})]})}}]),i}(a.a.Component),h=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,31)).then((function(t){var i=t.getCLS,n=t.getFID,a=t.getFCP,o=t.getLCP,d=t.getTTFB;i(e),n(e),a(e),o(e),d(e)}))};i(28);d.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(g,{})}),document.getElementById("root")),h()}},[[30,1,2]]]);
//# sourceMappingURL=main.d8cc01b6.chunk.js.map